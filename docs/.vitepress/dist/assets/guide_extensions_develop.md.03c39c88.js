import{_ as s,c as a,o as n,e as l}from"./app.5d5e80c5.js";const A=JSON.parse('{"title":"开发扩展","description":"","frontmatter":{"title":"开发扩展"},"headers":[{"level":2,"title":"创建扩展","slug":"创建扩展","link":"#创建扩展","children":[{"level":3,"title":"格式","slug":"格式","link":"#格式","children":[]}]},{"level":2,"title":"配置","slug":"配置","link":"#配置","children":[{"level":3,"title":"logo","slug":"logo","link":"#logo","children":[]},{"level":3,"title":"文档","slug":"文档","link":"#文档","children":[]},{"level":3,"title":"composer.json","slug":"composer-json","link":"#composer-json","children":[]}]},{"level":2,"title":"功能开发","slug":"功能开发","link":"#功能开发","children":[{"level":3,"title":"路由","slug":"路由","link":"#路由","children":[]},{"level":3,"title":"菜单","slug":"菜单","link":"#菜单","children":[]},{"level":3,"title":"语言包","slug":"语言包","link":"#语言包","children":[]},{"level":3,"title":"前端","slug":"前端","link":"#前端","children":[]},{"level":3,"title":"中间件","slug":"中间件","link":"#中间件","children":[]},{"level":3,"title":"扩展配置","slug":"扩展配置","link":"#扩展配置","children":[]},{"level":3,"title":"发布到 Packagist.org","slug":"发布到-packagist-org","link":"#发布到-packagist-org","children":[]}]}],"relativePath":"guide/extensions/develop.md","lastUpdated":1676533519000}'),p={name:"guide/extensions/develop.md"},e=l(`<h1 id="开发扩展" tabindex="-1">开发扩展 <a class="header-anchor" href="#开发扩展" aria-hidden="true">#</a></h1><h2 id="创建扩展" tabindex="-1">创建扩展 <a class="header-anchor" href="#创建扩展" aria-hidden="true">#</a></h2><p>在扩展管理中使用 <code>创建扩展</code> 来生成一个扩展的骨架。</p><p>配置相应的报名及命名空间，然后点击 <code>确认</code> 即可。</p><h3 id="格式" tabindex="-1">格式 <a class="header-anchor" href="#格式" aria-hidden="true">#</a></h3><ul><li>包名: 作者名/扩展名 (例如: slowlyo/banner)</li><li>命名空间: 作者名\\扩展名 (例如: Slowlyo\\Banner)</li></ul><p>扩展包创建完成后，会在 <code>extensions</code> 目录下生成一个扩展包的骨架，目录结构如下:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">    ├── .gitignore</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── composer.json   # composer配置文件, 需要自行配置alias/authors/description等信息, 用于展示</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── README.md   # 扩展说明文档, 可以在扩展管理中查看</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── database</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   └── migrations  # 数据库迁移文件, 与laravel的迁移文件一致</span></span>
<span class="line"><span style="color:#A6ACCD;">    ├── resources</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   └── admin-views</span></span>
<span class="line"><span style="color:#A6ACCD;">    │       └── extensions  # 扩展前端文件, 只会发布到resources/admin-views/extensions目录下</span></span>
<span class="line"><span style="color:#A6ACCD;">    │           └── slowlyo</span></span>
<span class="line"><span style="color:#A6ACCD;">    │               └── banner</span></span>
<span class="line"><span style="color:#A6ACCD;">    └── src</span></span>
<span class="line"><span style="color:#A6ACCD;">        ├── BannerServiceProvider.php   # 扩展服务提供者</span></span>
<span class="line"><span style="color:#A6ACCD;">        └── Http</span></span>
<span class="line"><span style="color:#A6ACCD;">            ├── routes.php  # 扩展路由</span></span>
<span class="line"><span style="color:#A6ACCD;">            ├── Middleware  # 扩展中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">            └── Controllers # 扩展控制器</span></span>
<span class="line"><span style="color:#A6ACCD;">                └── BannerController.php</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-hidden="true">#</a></h2><h3 id="logo" tabindex="-1">logo <a class="header-anchor" href="#logo" aria-hidden="true">#</a></h3><p>在插件根目录下添加 <code>logo.png</code> 文件，用于在扩展管理中展示。</p><h3 id="文档" tabindex="-1">文档 <a class="header-anchor" href="#文档" aria-hidden="true">#</a></h3><p>根目录的 <code>README.md</code> 文件, 会在扩展管理中展示。</p><h3 id="composer-json" tabindex="-1">composer.json <a class="header-anchor" href="#composer-json" aria-hidden="true">#</a></h3><table><thead><tr><th>字段</th><th>说明</th></tr></thead><tbody><tr><td>alias</td><td>扩展名称(在扩展管理中以这个为主)</td></tr><tr><td>authors</td><td>作者信息</td></tr><tr><td>description</td><td>描述信息</td></tr><tr><td>version</td><td>版本号</td></tr><tr><td>homepage</td><td>扩展主页</td></tr></tbody></table><hr><h2 id="功能开发" tabindex="-1">功能开发 <a class="header-anchor" href="#功能开发" aria-hidden="true">#</a></h2><h3 id="路由" tabindex="-1">路由 <a class="header-anchor" href="#路由" aria-hidden="true">#</a></h3><p>你可以在 <code>extensions/扩展名/src/Http/routes.php</code> 文件中定义扩展的路由。 注意避免重复</p><h3 id="菜单" tabindex="-1">菜单 <a class="header-anchor" href="#菜单" aria-hidden="true">#</a></h3><p>在<code>src/BannerServiceProvider.php</code> 中添加 <code>$menu</code> 属性:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">title</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">轮播</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/banner</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url_type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">icon</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fa fa-users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">parent</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">轮播</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 此处父级菜单根据 title 查找</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">title</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">子菜单</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/banner/child</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url_type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">icon</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fa fa-users</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#89DDFF;">];</span></span>
<span class="line"></span></code></pre></div><h3 id="语言包" tabindex="-1">语言包 <a class="header-anchor" href="#语言包" aria-hidden="true">#</a></h3><p>在扩展目录下创建 <code>lang</code> 目录, 逻辑与laravel的语言包一致, 例如:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">    ├── lang</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   ├── zh-CN</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   │   └── banner.php</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   └── en</span></span>
<span class="line"><span style="color:#A6ACCD;">    │       └── banner.php</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>在控制器中可以通过下面的方法访问语言包内容，关于多语言的更多用法可以参考 laravel 官方文档</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#A6ACCD;">Slowlyo</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">Banner</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">BannerServiceProvider</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">BannerServiceProvider</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">trans</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">title</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="前端" tabindex="-1">前端 <a class="header-anchor" href="#前端" aria-hidden="true">#</a></h3><p>在扩展的前端目录下创建你的文件, 例如:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">    ├── resources</span></span>
<span class="line"><span style="color:#A6ACCD;">    │   └── admin-views</span></span>
<span class="line"><span style="color:#A6ACCD;">    │       └── src</span></span>
<span class="line"><span style="color:#A6ACCD;">    │           └── extensions</span></span>
<span class="line"><span style="color:#A6ACCD;">    │               └── slowlyo</span></span>
<span class="line"><span style="color:#A6ACCD;">    │                   ├── Banner</span></span>
<span class="line"><span style="color:#A6ACCD;">    │                   │   └── index.vue</span></span>
<span class="line"><span style="color:#A6ACCD;">    │                   └── other.js</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>在文档中说明如何使用你的前端文件。</p><h4 id="前端获取扩展启用状态" tabindex="-1">前端获取扩展启用状态 <a class="header-anchor" href="#前端获取扩展启用状态" aria-hidden="true">#</a></h4><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">settings</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@/utils</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">useAppStore</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@/store</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 注意此处扩展名以 . 分隔</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">slowlyo.banner</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> enabled </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> settings</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setStore</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">useAppStore</span><span style="color:#A6ACCD;">())</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extensionIsEnable</span><span style="color:#A6ACCD;">(name)</span></span>
<span class="line"></span></code></pre></div><h3 id="中间件" tabindex="-1">中间件 <a class="header-anchor" href="#中间件" aria-hidden="true">#</a></h3><p>在<code>src/BannerServiceProvider.php</code> 中添加 <code>$middleware</code> 属性:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">protected</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">middleware </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">LogOperation</span><span style="color:#89DDFF;">::</span><span style="color:#F78C6C;">class</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// ...</span></span>
<span class="line"><span style="color:#89DDFF;">];</span></span>
<span class="line"></span></code></pre></div><h3 id="扩展配置" tabindex="-1">扩展配置 <a class="header-anchor" href="#扩展配置" aria-hidden="true">#</a></h3><p>在<code>src/BannerServiceProvider.php</code> 中有以下方法, 依葫芦画瓢即可:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">settingForm</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$this-&gt;</span><span style="color:#82AAFF;">baseSettingForm</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">body</span><span style="color:#89DDFF;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#FFCB6B;">TextControl</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">make</span><span style="color:#89DDFF;">()-&gt;</span><span style="color:#82AAFF;">name</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">value</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">label</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Value</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)-&gt;</span><span style="color:#82AAFF;">required</span><span style="color:#89DDFF;">(true),</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 继续添加你的配置项</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">]);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>你可以使用 <code>setting</code> 方法来获取配置项的值:</p><div class="language-php"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#FFCB6B;"> </span><span style="color:#A6ACCD;">Slowlyo</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">Banner</span><span style="color:#89DDFF;">\\</span><span style="color:#A6ACCD;">BannerServiceProvider</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 读取配置参数</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">except </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BannerServiceProvider</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">setting</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">except</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 支持多级配置</span></span>
<span class="line"><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">except </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">BannerServiceProvider</span><span style="color:#89DDFF;">::</span><span style="color:#82AAFF;">setting</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">except.value</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span></code></pre></div><h3 id="发布到-packagist-org" tabindex="-1">发布到 <a href="http://Packagist.org" target="_blank" rel="noreferrer">Packagist.org</a> <a class="header-anchor" href="#发布到-packagist-org" aria-hidden="true">#</a></h3><p>参考 <a href="https://learnku.com/docs/composer/2018" target="_blank" rel="noreferrer">Packagist 中文文档</a></p>`,43),o=[e];function t(c,r,D,i,y,F){return n(),a("div",null,o)}const d=s(p,[["render",t]]);export{A as __pageData,d as default};
